/*!
 * Tubeyflaps
 * Tubeyflaps
 * http://appsbu.de
 * @author Carsten Sandtner
 * @version 0.3.0
 * Copyright 2014. MIT licensed.
 */

var Bird=function(a,b,c){this.game=b,c=c||this.game.world.width+50,this.rangeYMin=this.game.world.height/6,this.rangeYMax=this.game.world.height-100,this.x=c,this.y=this.game.rnd.integerInRange(this.rangeYMin,this.rangeYMax),this.alive=!0,this.bird=this.game.add.sprite(this.x,this.y,"bird"),this.bird.name=a,this.bird.scale.x*=-1,this.bird.animations.add("flap"),this.bird.animations.play("flap",10,!0),this.bird.body.velocity.x=-200,this.scored=!1};Bird.prototype.update=function(){!this.scored&&this.bird.x<=100&&(this.scored=!0,this.game.score+=1),this.bird.x<=-50&&(this.bird.x=this.game.world.width+50,this.bird.y=this.game.rnd.integerInRange(this.rangeYMin,this.rangeYMax),this.scored=!1)},Bird.prototype.getSprite=function(){return this.bird};var Tube=function(a,b,c){this.game=b;var d,e,f,g,h=this.game.world.height,i=200;this.x=this.game.world.width/5,this.y=0,this.index=a,this.gap=100,this.heightTop=h/2-40-this.gap/2,this.heightBottom=h-this.heightTop-80-this.gap,this.isAlive=!0,this.tubes=c,d=b.add.sprite(this.x,this.y+h+i,"tube"),this.bottomTubeTop=e=b.add.sprite(this.x,this.y+h-this.heightBottom,"tubetop"),e.anchor.setTo(.5,.5),d.anchor.setTo(.5,.5),d.scale.y=12,f=b.add.sprite(this.x,this.y-i,"tube"),g=b.add.sprite(this.x,this.y+this.heightTop,"tubetop"),g.anchor.setTo(.5,.5),f.anchor.setTo(.5,.5),f.scale.y=12,g.scale.y*=-1,this.tubes.add(d),this.tubes.add(e),this.tubes.add(g),this.tubes.add(f),this.tubes.name=a,this.tubes.setAll("body.gravity.y",1250)};Tube.prototype.update=function(){this.bottomTubeTop.y>400&&(this.isAlive=!1)},Tube.prototype.up=function(a){a="undefined"==typeof a?-300:a,this.tubes.setAll("body.velocity.y",a)},Tube.prototype.getGroup=function(){return this.tubes},TubyFlaps={},TubyFlaps.Boot=function(){},TubyFlaps.Boot.prototype={preload:function(){},create:function(){this.game.input.maxPointers=1,this.game.stage.disableVisibilityChange=!0,this.game.device.desktop?this.game.stage.scale.pageAlignHorizontally=!0:(this.game.stage.scaleMode=Phaser.StageScaleMode.SHOW_ALL,this.game.stage.scale.minWidth=480,this.game.stage.scale.minHeight=260,this.game.stage.scale.maxWidth=1024,this.game.stage.scale.maxHeight=768,this.game.stage.scale.forceLandscape=!0,this.game.stage.scale.pageAlignHorizontally=!0,this.game.stage.scale.setScreenSize(!0)),this.game.state.start("Preloader")}},TubyFlaps.Game=function(a){this.game=a,this.game.score=0,this.game.highscore=0},TubyFlaps.Game.prototype={create:function(){this.game.stage.backgroundColor="#AFD8FA",this.tubes=this.game.add.group(),this.tubey=new Tube("2",this.game,this.tubes),this.birds=[],this.birds.push(new Bird("flapy1",this.game)),this.birds.push(new Bird("flapy2",this.game,this.game.world.width+75+this.game.world.width/2)),this.key=!1,this.game.score=0,this.text=game.add.text(30,20,"Score: \n0",{font:"16px Arial",fill:"#000000",align:"center"}),this.text.anchor.setTo(.5,.5),this.land=this.game.add.tileSprite(0,this.game.world.height-48,this.game.world.width,48,"ground")},update:function(){this.key||!this.game.input.keyboard.isDown(Phaser.Keyboard.UP)&&!this.game.input.pointer1.isDown||(this.key=!0,this.tubey.up()),(this.game.input.keyboard.justReleased(Phaser.Keyboard.UP,25)||this.game.input.pointer1.isUp)&&(this.key=!1),this.tubey.update();for(var a=0,b=this.birds.length;b>a;a++)this.birds[a].update(),this.game.physics.overlap(this.birds[a].getSprite(),this.tubey.getGroup(),this.collisionHandler,null,this);this.renderScore(),this.tubey.isAlive||this.quitGame(),this.land.tilePosition.x-=2.5},collisionHandler:function(){this.quitGame()},quitGame:function(){this.game.state.start("MainMenu")},renderScore:function(){this.text.setText("Score: \n"+this.game.score)}},TubyFlaps.MainMenu=function(a){this.game=a},TubyFlaps.MainMenu.prototype={create:function(){this.game.highscore=this.game.score>this.game.highscore?this.game.score:this.game.highscore,this.tubes=this.game.add.group(),this.tubey=new Tube("2",this.game,this.tubes);var a="Pres UP to play!\n\nHighscore: "+this.game.highscore;this.game.stage.backgroundColor="#AFD8FA",this.text=game.add.text(this.game.world.width/2,this.game.world.height/2+15,a,{font:"28px Arial",fill:"#000000",align:"center"}),this.keylocked=!0,this.text.anchor.setTo(.5,.5);var b=this.game.add.sprite(this.game.world.width/2,75,"logo");b.scale.y=.75,b.scale.x=.75,b.anchor.setTo(.5,.5),this.land=this.game.add.tileSprite(0,this.game.world.height-48,this.game.world.width,48,"ground")},update:function(){this.keylocked||!this.game.input.keyboard.isDown(Phaser.Keyboard.UP)&&!this.game.input.pointer1.isDown||this.startGame(),(this.game.input.keyboard.justReleased(Phaser.Keyboard.UP,3e3)||this.game.input.pointer1.isUp)&&(this.keylocked=!1),this.tubey.update(),this.tubey.isAlive||(this.tubey.up(-700),this.tubey.isAlive=!0),this.land.tilePosition.x-=2.5},startGame:function(){this.game.state.start("Game")}},TubyFlaps.Preloader=function(){this.background=null},TubyFlaps.Preloader.prototype={preload:function(){this.load.image("tubetop","assets/img/pipe-top.png"),this.load.image("tube","assets/img/pipe.png"),this.load.image("logo","assets/img/menu_logo.png"),this.load.spritesheet("bird","assets/img/bird.png",34,24,4),this.load.image("ground","assets/img/land_w.png")},create:function(){},update:function(){this.game.state.start("MainMenu")}};
//# sourceMappingURL=game/game.map