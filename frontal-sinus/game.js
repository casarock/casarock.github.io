/*!
 * project-name
 * project description
 * http://site.com
 * @author Author
 * @version 0.1.0
 * Copyright 2014. MIT licensed.
 */

BasicGame={},BasicGame.Boot=function(a){this.game=a},BasicGame.Boot.prototype={preload:function(){this.load.image("preloaderBackground","assets/img/ooze.png"),this.load.image("preloaderBar","assets/img/zelda-hearts.png")},create:function(){this.game.METADATA={score:0,highscore:0,localStorageKey:"de.appsbude.frontalsinus.score",musicPlaying:!0},this.game.input.maxPointers=1,this.game.stage.disableVisibilityChange=!0,this.game.device.desktop?this.game.scale.pageAlignHorizontally=!0:(this.game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.game.scale.minWidth=320,this.game.scale.minHeight=240,this.game.scale.maxWidth=1024,this.game.scale.maxHeight=768,this.game.scale.pageAlignHorizontally=!0,this.game.scale.pageAlignVertically=!0,this.game.scale.setScreenSize(!0)),this.game.state.start("Preloader")}},BasicGame.Game=function(a){this.game=a,this.cursors=null,this.wasd=null,this.velocity=200},BasicGame.Game.prototype={create:function(){this.gameOver=!1,this.SHOT_DELAY=200,this.BULLET_SPEED=500,this.NUMBER_OF_BULLETS=20,this.NUMBER_OF_ENEMIES=20,this.NUMBER_OF_MEDIPACKS=5,this.MEDIPACK_SPAWN_DELAY_MIN=5e3,this.MEDIPACK_COLLISION_DELAY=250,this.score=0,this.lastBulletShotAt=0,this.lastEnemySpawned=0,this.lastMedipackSpawned=0,this.lastMedipackCollected=0,this.antibioticsPerMedipack=10,this.survivedTime=0,this.availableBullets=5,this.enemySpawnDelay=3e3,this.enemySpeed=75,this.game.physics.startSystem(Phaser.Physics.ARCADE),this.setupKeys(),this.background=this.add.tileSprite(0,0,this.game.width,this.game.height,"preloaderBackground"),this.createMedicinePool(),this.tank=this.add.sprite(this.game.width/2,this.game.height/2,"tanks","tankBeige_outline.png"),this.createBulletPool(),this.turret=this.add.sprite(this.tank.x,this.tank.y,"tanks","barrelBeige_outline.png"),this.createEnemyPool(),this.crosshair=this.add.sprite(0,0,"crosshair"),this.tank.anchor.setTo(.5,.5),this.turret.anchor.setTo(.5,.8),this.crosshair.anchor.setTo(.5,3),this.tank.scale.setTo(.5,.5),this.turret.scale.setTo(.5,.5),this.crosshair.scale.setTo(.5,.5),this.game.physics.enable(this.tank,Phaser.Physics.ARCADE),this.game.physics.enable(this.turret,Phaser.Physics.ARCADE),this.tank.body.collideWorldBounds=!0,this.game.input.activePointer.x=this.game.width/2,this.game.input.activePointer.y=this.game.height/2,this.scoreText=this.game.add.bitmapText(10,10,"bmpfont","Score: 0"),this.ammoText=this.game.add.bitmapText(this.game.width-180,10,"bmpfont","antibiotics: 250"),this.timerText=this.game.add.bitmapText(10,this.game.height-28,"bmpfont","time: 0"),this.scoreText.scale.setTo(.5,.5),this.ammoText.scale.setTo(.5,.5),this.sfxShoot=this.add.audio("shoot"),this.sfxBeep=this.add.audio("beep"),this.sfxTankExplosion=this.add.audio("tankexplosion"),this.sfxBacteriaDestroyed=this.add.audio("bacteriadestroyed"),this.game.METADATA.musicPlaying&&(this.music=this.add.audio("game",1,!0),this.music.play("",0,1,!0)),this.timer=this.game.time.create(!1),this.timer.add(1e3,this.updateTime,this),this.timer.start()},createBulletPool:function(){this.bulletPool=this.game.add.group();for(var a=0;a<this.NUMBER_OF_BULLETS;a++){var b=this.game.add.sprite(0,0,"tanks","bulletSilver_outline.png");this.bulletPool.add(b),b.anchor.setTo(.5,.8),b.scale.setTo(.5,.5),this.game.physics.enable(b,Phaser.Physics.ARCADE),b.kill()}},createEnemyPool:function(){this.enemyPool=this.game.add.group();for(var a=0;a<this.NUMBER_OF_ENEMIES;a++){var b=this.game.add.sprite(0,0,"tanks","treeLarge.png");this.enemyPool.add(b),b.anchor.setTo(.5,.5),this.game.physics.enable(b,Phaser.Physics.ARCADE),b.kill()}},createMedicinePool:function(){this.medicinePool=this.game.add.group();for(var a=0;a<this.NUMBER_OF_MEDIPACKS;a++){var b=this.game.add.sprite(0,0,"tanks","barrelGreen_side_damaged.png");this.medicinePool.add(b),b.anchor.setTo(.5,.5),b.scale.setTo(.5,.5),this.game.physics.enable(b,Phaser.Physics.ARCADE),b.kill()}},spawnMediPack:function(){var a=this.game.rnd.integerInRange(1e3,7500),b=this.MEDIPACK_SPAWN_DELAY_MIN+a;if(!(this.game.time.now-this.lastMedipackSpawned<b)){this.lastMedipackSpawned=this.game.time.now;var c=this.medicinePool.getFirstDead();if(null!==c&&void 0!==c){c.revive();var d=this.game.rnd.integerInRange(10,this.game.width-10),e=this.game.rnd.integerInRange(10,this.game.height-10);c.reset(d,e),c.alpha=0,this.game.add.tween(c).to({alpha:1},500,Phaser.Easing.Linear.None,!0).to({y:c.y+10},1e3,Phaser.Easing.Bounce.Out,!0),this.game.time.events.add(5*Phaser.Timer.SECOND,this.removeMediPack.bind(this,c),this)}}},removeMediPack:function(a,b,c){b=b||500,this.game.add.tween(a).to({alpha:0},b,Phaser.Easing.Linear.None,!0).onComplete.addOnce(function(){a.kill(),c&&(this.availableBullets+=this.antibioticsPerMedipack)},this)},spawnEnemy:function(){if(!(this.game.time.now-this.lastEnemySpawned<this.enemySpawnDelay)){this.lastEnemySpawned=this.game.time.now;var a=this.enemyPool.getFirstDead();if(null!==a&&void 0!==a){a.revive(),a.checkWorldBounds=!0,a.outOfBoundsKill=!0;var b,c,d=this.game.rnd.integerInRange(0,4),e=this.game.rnd.realInRange(.25,1);switch(d){case 0:b=-48,c=this.game.rnd.integerInRange(0,this.game.width);break;case 1:c=this.game.width+48,b=this.game.rnd.integerInRange(0,this.game.height);break;case 2:b=this.game.height+48,c=this.game.rnd.integerInRange(0,this.game.width);break;case 4:default:b=this.game.rnd.integerInRange(0,this.game.height),c=-48}a.reset(c,b),a.scale.setTo(e,e),a.rotation=this.game.physics.arcade.angleBetween(this.tank,a),a.body.velocity.x=Math.cos(a.rotation)*-this.enemySpeed,a.body.velocity.y=Math.sin(a.rotation)*-this.enemySpeed}}},shootBullet:function(){if(!(this.availableBullets<=0||this.game.time.now-this.lastBulletShotAt<this.SHOT_DELAY)){this.lastBulletShotAt=this.game.time.now;var a=this.bulletPool.getFirstDead();if(null!==a&&void 0!==a){a.revive(),a.checkWorldBounds=!0,a.outOfBoundsKill=!0,a.reset(this.turret.x,this.turret.y),a.rotation=this.turret.rotation,a.body.velocity.x=Math.cos(this.fixRotation(a.rotation))*-this.BULLET_SPEED,a.body.velocity.y=Math.sin(this.fixRotation(a.rotation))*-this.BULLET_SPEED;var b=this.add.sprite(this.turret.x,this.turret.y,"tanks","smokeWhite3.png");b.scale.setTo(.3,.3),b.anchor.setTo(.5,1.4),b.rotation=this.turret.rotation,b.alpha=.1;var c=this.add.tween(b);c.to({alpha:.75},100,Phaser.Easing.Cubic.InOut);var d=this.add.tween(b);d.to({alpha:0},500,Phaser.Easing.Cubic.InOut),d.onComplete.add(function(){b.destroy()}.bind(this)),c.chain(d),c.start(),this.availableBullets--,this.sfxShoot.play()}}},setupKeys:function(){this.cursors=this.game.input.keyboard.createCursorKeys(),this.wasd={up:this.game.input.keyboard.addKey(Phaser.Keyboard.W),down:this.game.input.keyboard.addKey(Phaser.Keyboard.S),left:this.game.input.keyboard.addKey(Phaser.Keyboard.A),right:this.game.input.keyboard.addKey(Phaser.Keyboard.D),fire:this.game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR)}},fixRotation:function(a){return a+1.57079633},handleInput:function(){this.wasd.up.isDown&&this.tank.body.velocity.copyFrom(this.game.physics.arcade.velocityFromAngle(this.tank.angle-90,this.velocity)),this.wasd.down.isDown&&this.tank.body.velocity.copyFrom(this.game.physics.arcade.velocityFromAngle(this.tank.angle-90,-this.velocity)),this.wasd.left.isDown&&(this.tank.body.angularVelocity=-this.velocity),this.wasd.right.isDown&&(this.tank.body.angularVelocity=+this.velocity),this.wasd.fire.isDown&&this.shootBullet()},update:function(){this.gameOver?this.input.activePointer.isDown&&this.quitGame():(this.turret.rotation=this.crosshair.rotation=this.tank.rotation,this.tank.body.velocity.x=0,this.tank.body.velocity.y=0,this.tank.body.angularVelocity=0,this.handleInput(),this.spawnEnemy(),this.spawnMediPack(),this.updateHUD(),this.game.physics.arcade.overlap(this.bulletPool,this.enemyPool,this.bulletCollisonHandler,null,this),this.game.physics.arcade.overlap(this.tank,this.enemyPool,this.tankCollisonHandler,null,this),this.game.physics.arcade.overlap(this.tank,this.medicinePool,this.mediPackCollisionHandler,null,this),this.turret.x=this.crosshair.x=this.tank.x,this.turret.y=this.crosshair.y=this.tank.y)},updateHUD:function(){this.scoreText.setText("Score: "+this.score),this.ammoText.setText("antibiotics: "+this.availableBullets),this.timerText.setText("time: "+this.survivedTime)},updateTime:function(){this.survivedTime+=1,this.survivedTime%10===0&&(this.enemySpawnDelay-=500,this.enemySpawnDelay=this.enemySpawnDelay<500?250:this.enemySpawnDelay),this.survivedTime%25===0&&(this.enemySpeed+=25),this.survivedTime%60===0&&(this.antibioticsPerMedipack+=10),this.timer.add(1e3,this.updateTime,this),this.timer.start()},bulletCollisonHandler:function(a,b){b.kill(),a.kill(),this.sfxBacteriaDestroyed.play(),this.score+=10},tankCollisonHandler:function(){this.tank.body.velocity.x=0,this.tank.body.velocity.y=0,this.tank.body.angularVelocity=0;var a=this.add.sprite(this.tank.position.x,this.tank.position.y,"explode");this.tank.destroy(),this.turret.destroy(),a.anchor.set(.5,.5),a.animations.add("boom"),a.animations.play("boom",20),this.sfxTankExplosion.play(),this.enemyPool.destroy(),this.bulletPool.destroy(),this.medicinePool.destroy(),this.showGameOverScreen(),this.gameOver=!0},mediPackCollisionHandler:function(a,b){this.game.time.now-this.lastMedipackCollected>this.MEDIPACK_COLLISION_DELAY&&(this.removeMediPack(b,100,!0),this.sfxBeep.play(),this.lastMedipackCollected=this.game.time.now)},quitGame:function(){this.score>this.game.METADATA.highscore&&(this.game.METADATA.highscore=this.score,window.localStorage.setItem(this.game.METADATA.localStorageKey,this.game.METADATA.highscore)),this.game.METADATA.musicPlaying&&(this.music.stop(),this.music.destroy()),this.scoreText.destroy(),this.ammoText.destroy(),this.timerText.destroy(),this.panel.destroy(),this.continueText.destroy(),this.gameoverText.destroy(),this.sfxBacteriaDestroyed.destroy(),this.sfxShoot.destroy(),this.sfxTankExplosion.destroy(),this.game.state.start("MainMenu")},render:function(){},renderGroup:function(a){this.game.debug.body(a)},showGameOverScreen:function(){this.panel=this.add.sprite(0,this.game.height/2,"ui","glassPanel.png"),this.panel.position.x=this.game.width/2-3*this.panel.width/2,this.panel.position.y=this.game.height/2-1.5*this.panel.height/2,this.panel.scale.setTo(3,1.5),this.gameoverText=this.game.add.bitmapText(0,this.panel.position.y+24,"bmpfont","Game Over!"),this.gameoverText.x=this.game.width/2-this.gameoverText.width/2,this.continueText=this.game.add.bitmapText(0,this.panel.position.y+96,"bmpfont","Click me!"),this.continueText.x=this.game.width/2-this.continueText.width/2}},BasicGame.MainMenu=function(a){this.game=a,this.music=null,this.playButton=null,this.count=0},BasicGame.MainMenu.prototype={create:function(){this.background=this.add.tileSprite(0,0,this.game.width,this.game.height,"preloaderBackground"),this.playButton=this.add.button(this.game.width/2,this.game.height/2,"playButton",this.startGame,this),this.playButton.anchor.set(.5,.5),this.speakerButton=this.add.button(this.game.width-64,64,"speakerbtn",this.toggleMusic,this,0,0,1,0),this.speakerButton.anchor.set(.5,.5),this.speakerButton.scale.set(.5,.5),this.introText1=this.game.add.bitmapText(this.game.width/2,50,"bmpfont","Collect: "),this.introText2=this.game.add.bitmapText(this.game.width/2,125,"bmpfont","Shoot: "),this.introText1.position.x=this.game.width/2-this.introText1.width/2,this.introText2.position.x=this.game.width/2-this.introText2.width/2,this.barrel=this.add.sprite(this.introText1.position.x+this.introText1.width+32,this.introText1.position.y+10,"tanks","barrelGreen_side_damaged.png"),this.barrel.scale.set(.5,.5),this.barrel.anchor.set(.5,.5),this.barrel.angle=-15,this.bacteria=this.add.sprite(this.introText2.position.x+this.introText2.width+32,this.introText2.position.y+10,"tanks","treeLarge.png"),this.bacteria.scale.set(.5,.5),this.bacteria.anchor.set(.5,.5),this.highscoreText=this.game.add.bitmapText(16,this.game.height-32,"bmpfont","Highscore: "+this.getHighscore());var a=this.add.tween(this.highscoreText.scale);a.start(),a.to({x:1.05,y:1.05},500,Phaser.Easing.Cubic.InOut,!0,0,500,!0).loop(!0);var b=this.add.tween(this.bacteria);b.start(),b.to({angle:359},3e3,Phaser.Easing.Linear.None,!0,0,1/0);var c=this.add.tween(this.barrel);c.start(),c.to({angle:15},500,Phaser.Easing.Linear.None,!0,0,500,!0).loop(!0),this.game.METADATA.musicPlaying?(this.music=this.add.audio("menu",1,!0),this.music.play("",0,1,!0),this.game.METADATA.musicPlaying=!0):this.speakerButton.setFrames(1,1,0,1)},update:function(){this.count+=.005,this.background.tilePosition.x+=1+Math.sin(this.count),this.background.tilePosition.y+=Math.cos(this.count)},getHighscore:function(){var a=window.localStorage.getItem(this.game.METADATA.localStorageKey)||0;return this.game.METADATA.highscore=a,this.pad(a,5)},pad:function(a,b,c){return c=c||"0",a+="",a.length>=b?a:new Array(b-a.length+1).join(c)+a},startGame:function(){this.music.stop(),this.game.state.start("Game")},toggleMusic:function(){this.game.METADATA.musicPlaying=!this.game.METADATA.musicPlaying,this.game.METADATA.musicPlaying?(this.music.play(),this.speakerButton.setFrames(0,0,1,0)):(this.music.stop(),this.speakerButton.setFrames(1,1,0,1))}},BasicGame.Preloader=function(a){this.game=a,this.background=null,this.preloadBar=null,this.ready=!1},BasicGame.Preloader.prototype={preload:function(){this.background=this.add.sprite(0,0,"preloaderBackground"),this.preloadBar=this.add.sprite(this.game.width/2-79,this.game.height/2,"preloaderBar"),this.preloadBar.scale.set(1.5,1.5),this.preloadBar.anchor.set(.5,.5),this.load.setPreloadSprite(this.preloadBar),this.load.atlasXML("tanks","assets/img/sheet_tanks.png","assets/img/sheet_tanks.xml"),this.load.atlasXML("ui","assets/img/ui.png","assets/img/ui.xml"),this.load.spritesheet("speakerbtn","assets/img/speaker_btn.png",128,128),this.load.spritesheet("explode","assets/img/exp2_0.png",64,64),this.load.image("playButton","assets/img/button_play.png"),this.load.image("crosshair","assets/img/crosshair6.png"),this.load.audio("menu",["assets/audio/menu.mp3","assets/audio/menu.ogg"]),this.load.audio("game",["assets/audio/game.mp3","assets/audio/game.ogg"]),this.load.audio("shoot","assets/audio/flaunch.wav"),this.load.audio("tankexplosion","assets/audio/explosion.wav"),this.load.audio("bacteriadestroyed","assets/audio/boom3.wav"),this.load.audio("beep","assets/audio/beep.wav"),this.load.bitmapFont("bmpfont","assets/img/kenny.png","assets/img/kenny.fnt")},create:function(){this.preloadBar.cropEnabled=!1},update:function(){this.cache.isSoundDecoded("menu")&&this.ready===!1&&(this.ready=!0,this.game.state.start("MainMenu"))}};
//# sourceMappingURL=game/game.map